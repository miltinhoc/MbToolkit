using System;
using System.IO;

namespace MalwarebytesToolkit.Manager
{
    public class FileManager
    {
        private static readonly string _programFiles = Environment.ExpandEnvironmentVariables("%ProgramW6432%");
        private static readonly string _programFilesX86 = Environment.ExpandEnvironmentVariables("%ProgramFiles(x86)%");
        private static readonly string _path = "Malwarebytes\\Anti-Malware";
        private static readonly string _mbPath64 = Path.Combine(_programFiles, _path);
        private static readonly string _mbPath86 = Path.Combine(_programFilesX86, _path);

        public bool MalwarebytesExists() => (Directory.Exists(_mbPath64) || Directory.Exists(_mbPath86));

        public string GetMalwarebytesPath() 
        {
            if (Directory.Exists(_mbPath64))
            {
                return _mbPath64;
            }

            if (Directory.Exists(_mbPath86))
            {
                return _mbPath86;
            }

            return string.Empty;
        }
    }
}
